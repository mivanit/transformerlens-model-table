<!DOCTYPE html>
<html>
<head>
    <title>JSONL Data Table</title>
	<script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>
    <style>
        header {
            background-color: #f4f4f4;
            padding: 10px;
            text-align: left;
        }
        .ag-theme-alpine {
            height: 500px;
            width: 100%;
        }
    </style>
</head>
<body>
    <header>
        Model table for <a href="https://github.com/neelnanda-io/TransformerLens">TransformerLens</a>. Source code: <a href="https://github.com/mivanit/transformerlens-model-table">github.com/mivanit/transformerlens-model-table</a>.
    </header>

    <div id="modelTable" class="ag-theme-alpine"></div>

    <script>
        // Assuming your JSONL data is an array of objects
        async function fetchJsonlData(url) {
            const response = await fetch(url);
            const text = await response.text();
            return text.trim().split('\n').map(line => JSON.parse(line));
        }

        async function setupGrid() {			
			const rowData = await fetchJsonlData('../data/model_table.jsonl');
			
			// get the column names from the first row
			const columnDefs = Object.keys(rowData[0]).map(key => {
				return {
					headerName: key,
					field: key,
				};
			});

			// create the grid
            const gridOptions = {
                columnDefs: columnDefs,
                rowData: rowData,
                enableRangeSelection: true,
                rowSelection: 'multiple',
				pagination: true,
				paginationPageSize: 500,
				paginationPageSizeSelector: [10, 25, 50, 100, 500, 1000],
				enableCellTextSelection: true,
				enableBrowserTooltips: true,
                defaultColDef: {
                    resizable: true,
                    filter: true,
                },
                domLayout: 'autoHeight',
            };

            new agGrid.Grid(document.getElementById('modelTable'), gridOptions);
        }

        setupGrid();
    </script>
</body>
</html>
